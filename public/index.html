<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Boilerplate App</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Firebase
    -   - latest versions -> https://firebase.google.com/support/release-notes/js
    -
    - Include only the Firebase features as you need.
    -
    - Note: Firebase docs mention to put this in the 'body' - instead of 'head'. Is there a benefit for doing so?
    -->
    <script defer src="/__/firebase/7.8.0/firebase-app.js"></script>
    <script defer src="/__/firebase/7.8.0/firebase-auth.js"></script>
    <!--
    <script defer src="/__/firebase/7.8.0/firebase-database.js"></script>
    <script defer src="/__/firebase/7.8.0/firebase-messaging.js"></script>
    <script defer src="/__/firebase/7.8.0/firebase-storage.js"></script>
    -->

    <!-- initialize the SDK (keep last) -->
    <script defer src="/__/firebase/init.js"></script>

    <!-- FirebaseUI
    -   - latest versions -> https://github.com/firebase/firebaseui-web/releases
    -
    - tbd. consider adding 'defer' - does it matter to us?
    -->
    <script src="https://www.gstatic.com/firebasejs/ui/4.4.0/firebase-ui-auth.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.4.0/firebase-ui-auth.css" />

    <!-- Basic loading check of 'firebase' and 'firebaseui' close to where we load them. Nothing app specific, here.
    -->
    <script>
      firebaseLoadedProm = new Promise( (resolve, reject) => {

        document.addEventListener('DOMContentLoaded', () => {   // Q: does this fire just once, or multiple times?
          try {
            let app = firebase.app();
            let features = ['auth'].filter(feature => typeof app[feature] === 'function');
            console.log(`Firebase SDK loaded with ${features.join(', ')}`);
            resolve();
          } catch (e) {
            console.error(e);
            alert('Error loading the Firebase SDK, check the console.');
            reject(e);
          }
        });

      } );

      const firebaseUiProm = Promise.resolve(firebaseui);
    </script>

    <!-- Application
    -->
    <script type="module" src="/bundle.esm.js"></script>
  </head>

  <body>
    <app></app>
  </body>
</html>
